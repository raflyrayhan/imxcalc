
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Heat Release & Cooling Airflow Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="p-4">

  <div class="container">
    <h2 class="mb-4 text-center">Heat Release & Required Cooling Airflow Calculator</h2>
    <div class="row g-3">
      <div class="col-md-6 mx-auto">
        <label class="form-label">Width (m)</label>
        <input type="number" class="form-control mb-3" id="width" step="0.01">

        <label class="form-label">Height (m)</label>
        <input type="number" class="form-control mb-3" id="height" step="0.01">

        <label class="form-label">Length (m)</label>
        <input type="number" class="form-control mb-3" id="length" step="0.01">

        <label class="form-label">Surface Temperature (°C)</label>
        <input type="number" class="form-control mb-3" id="surfaceTemp" step="0.1">

        <label class="form-label">Environmental Temperature (°C)</label>
        <input type="number" class="form-control mb-3" id="envTemp" step="0.1">

        <button class="btn btn-primary w-100 mt-3" onclick="calculateHeat()">Calculate</button>

        <div class="mt-4 border p-3 rounded bg-light">
          <h5>Result:</h5>
          <p id="result">-</p>
          <p id="airflowResult">-</p>
          <div class="d-flex gap-2">
            <button class="btn btn-outline-success" onclick="exportToExcel()">Export to Excel</button>
            <button class="btn btn-outline-danger" onclick="exportToPDF()">Export to PDF</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let calcData = {};

    function calculateHeat() {
      const width = parseFloat(document.getElementById('width').value);
      const height = parseFloat(document.getElementById('height').value);
      const length = parseFloat(document.getElementById('length').value);
      const surfaceTemp = parseFloat(document.getElementById('surfaceTemp').value);
      const envTemp = parseFloat(document.getElementById('envTemp').value);

      if (isNaN(width) || isNaN(height) || isNaN(length) || isNaN(surfaceTemp) || isNaN(envTemp)) {
        document.getElementById('result').innerText = "Please fill in all fields correctly.";
        document.getElementById('airflowResult').innerText = "";
        return;
      }

      const deltaT = surfaceTemp - envTemp;
      const h = 10;
      const area = 2 * (width * height + width * length + height * length);
      const Q = h * area * deltaT;

      const rho = 1.2;
      const cp = 1005;
      const airflow = Q / (rho * cp * deltaT);
      const airflow_hr = airflow * 3600;

      const resultText = `Estimated Heat Release: ${Q.toFixed(2)} W (Area: ${area.toFixed(2)} m², ΔT: ${deltaT}°C)`;
      const airflowText = `Required Cooling Airflow: ${airflow_hr.toFixed(2)} m³/h`;

      document.getElementById('result').innerText = resultText;
      document.getElementById('airflowResult').innerText = airflowText;

      calcData = {
        Width: width,
        Height: height,
        Length: length,
        SurfaceTemp: surfaceTemp,
        EnvTemp: envTemp,
        Area: area.toFixed(2),
        DeltaT: deltaT,
        HeatRelease_W: Q.toFixed(2),
        Airflow_m3h: airflow_hr.toFixed(2)
      };
    }

    function exportToExcel() {
      const ws = XLSX.utils.json_to_sheet([calcData]);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Results");
      XLSX.writeFile(wb, "Heat_Calculation_Result.xlsx");
    }

    function exportToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text("Heat Release & Cooling Airflow Result", 10, 10);
      let y = 20;
      for (const [key, value] of Object.entries(calcData)) {
        doc.text(`${key}: ${value}`, 10, y);
        y += 10;
      }
      doc.save("Heat_Calculation_Result.pdf");
    }
  </script>

</body>
</html>
